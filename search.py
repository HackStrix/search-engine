from pymongo import MongoClient
from bson.objectid import ObjectId
from datetime import datetime as time
import numpy as np
start = time.now()

client = MongoClient('mongodb+srv://admin:password1234$@web-map.qzzvr.mongodb.net/myFirstDatabase?retryWrites=true&w=majority')

db = client["web-map"]

x = db['domains']


import csv

with open('seed_url.csv', newline='') as f:
    reader = csv.reader(f)
    url = [row[0] for row in reader]
# print(url)
# ids = [ObjectId('61d8ed71b3de40c44097e0ff'), ObjectId('61d8efaab3de40c44097e933'), ObjectId('61d8ee02b3de40c44097e39a'), ObjectId('61d8ef5eb3de40c44097e853'), ObjectId('61d8ed68b3de40c44097e096'), ObjectId('61d8eda0b3de40c44097e20e'), ObjectId('61d8ed64b3de40c44097e05e'), ObjectId('61d8ef07b3de40c44097e74d'), ObjectId('61d8ef39b3de40c44097e7d5'), ObjectId('61d8ef16b3de40c44097e775'), ObjectId('61d8f19cb3de40c44097f113'), ObjectId('61d8f022b3de40c44097eb0d'), ObjectId('61d8ed68b3de40c44097e095'), ObjectId('61d8f19db3de40c44097f118'), ObjectId('61d8ed74b3de40c44097e10d'), ObjectId('61d8ed63b3de40c44097e05c'), ObjectId('61d8ed7eb3de40c44097e13f'), ObjectId('61d8eed1b3de40c44097e697'), ObjectId('61d8ef0cb3de40c44097e75b'), ObjectId('61d8ed7db3de40c44097e13d'), ObjectId('61d8f12bb3de40c44097ef51'), ObjectId('61d8ef08b3de40c44097e751'), ObjectId('61d8f03db3de40c44097eb85'), ObjectId('61d8ef18b3de40c44097e778'), ObjectId('61d8f07fb3de40c44097ec8a'), ObjectId('61d8ed67b3de40c44097e074'), ObjectId('61d8f343b3de40c44097f3d4'), ObjectId('61d8effbb3de40c44097ea64'), ObjectId('61d8ee69b3de40c44097e50b'), ObjectId('61d8eeb8b3de40c44097e64f'), ObjectId('61d8ed7eb3de40c44097e141'), ObjectId('61d8ee3bb3de40c44097e469'), ObjectId('61d8f06db3de40c44097ec52'), ObjectId('61d8ef90b3de40c44097e8fe'), ObjectId('61d8ee6db3de40c44097e51f'), ObjectId('61d8f0e1b3de40c44097ee03'), ObjectId('61d8ef2fb3de40c44097e7b3'), ObjectId('61d8ee89b3de40c44097e5aa'), ObjectId('61d8ed81b3de40c44097e155'), ObjectId('61d8f110b3de40c44097eee3'), ObjectId('61d8ed73b3de40c44097e107'), ObjectId('61d8ed69b3de40c44097e09d'), ObjectId('61d8edd5b3de40c44097e2f8'), ObjectId('61d8f358b3de40c44097f3df'), ObjectId('61d8f08fb3de40c44097ecca'), ObjectId('61d8f10ab3de40c44097eeb9'), ObjectId('61d8ef65b3de40c44097e86c'), ObjectId('61d8ef5bb3de40c44097e846'), ObjectId('61d8ed83b3de40c44097e162'), ObjectId('61d8f111b3de40c44097eee7'), ObjectId('61d8ed6ab3de40c44097e0ca'), ObjectId('61d8ee90b3de40c44097e5d1'), ObjectId('61d8ee8eb3de40c44097e5c6'), ObjectId('61d8f157b3de40c44097f00a'), ObjectId('61d8f073b3de40c44097ec66'), ObjectId('61d8ee10b3de40c44097e3d0'), ObjectId('61d8eeb6b3de40c44097e64b'), ObjectId('61d8ed7fb3de40c44097e147'), ObjectId('61d8eea8b3de40c44097e616'), ObjectId('61d8f10eb3de40c44097eed6'), ObjectId('61d8ee20b3de40c44097e40c'), ObjectId('61d8ed83b3de40c44097e167'), ObjectId('61d8eda3b3de40c44097e223'), ObjectId('61d8ed69b3de40c44097e0b9'), ObjectId('61d8ef41b3de40c44097e7ed'), ObjectId('61d8edd3b3de40c44097e2f2'), ObjectId('61d8f129b3de40c44097ef47'), ObjectId('61d8ed76b3de40c44097e11e'), ObjectId('61d8ed68b3de40c44097e07d'), ObjectId('61d8ee7ab3de40c44097e567'), ObjectId('61d8ee45b3de40c44097e495'), ObjectId('61d8eeefb3de40c44097e6fe'), ObjectId('61d8ed68b3de40c44097e091'), ObjectId('61d8f010b3de40c44097eac8'), ObjectId('61d8f0e9b3de40c44097ee23'), ObjectId('61d8ed69b3de40c44097e09e'), ObjectId('61d8f0dab3de40c44097ede4'), ObjectId('61d8f2d0b3de40c44097f341'), ObjectId('61d90d22b3de40c44097f680'), ObjectId('61d8ee39b3de40c44097e464'), ObjectId('61d8f20fb3de40c44097f206'), ObjectId('61d8efacb3de40c44097e93c'), ObjectId('61d8ed68b3de40c44097e087'), ObjectId('61d8f012b3de40c44097ead7'), ObjectId('61d8ed68b3de40c44097e08c'), ObjectId('61d8ed6ab3de40c44097e0c9'), ObjectId('61d8ef58b3de40c44097e83d'), ObjectId('61d8f07cb3de40c44097ec84'), ObjectId('61d8f120b3de40c44097ef22'), ObjectId('61d8ed6cb3de40c44097e0e1'), ObjectId('61d8ed68b3de40c44097e082'), ObjectId('61d8ef87b3de40c44097e8dd'), ObjectId('61d8f02bb3de40c44097eb2e'), ObjectId('61d8ed68b3de40c44097e089'), ObjectId('61d8ee88b3de40c44097e5a5'), ObjectId('61d8f0a5b3de40c44097ed03'), ObjectId('61d8ed66b3de40c44097e064'), ObjectId('61d8eeaeb3de40c44097e62d'), ObjectId('61d8f03db3de40c44097eb81'), ObjectId('61d8ee2bb3de40c44097e437'), ObjectId('61d8edb9b3de40c44097e295'), ObjectId('61d8ed6db3de40c44097e0e8'), ObjectId('61d8f19cb3de40c44097f114'), ObjectId('61d8eff5b3de40c44097ea4a'), ObjectId('61d8f042b3de40c44097eba5'), ObjectId('61d8ed7bb3de40c44097e135'), ObjectId('61d8ed6db3de40c44097e0e7'), ObjectId('61d8f10ab3de40c44097eeb6'), ObjectId('61d8f3c8b3de40c44097f469'), ObjectId('61d8ef15b3de40c44097e771'), ObjectId('61d8f083b3de40c44097ec9a'), ObjectId('61d8ed9eb3de40c44097e1fd'), ObjectId('61d8ed69b3de40c44097e0b3'), ObjectId('61d8edb9b3de40c44097e296'), ObjectId('61d8efbab3de40c44097e965'), ObjectId('61d8ed6bb3de40c44097e0dc'), ObjectId('61d8ed6ab3de40c44097e0d4'), ObjectId('61d8ef64b3de40c44097e868'), ObjectId('61d8ee8cb3de40c44097e5bb'), ObjectId('61d8ede3b3de40c44097e331'), ObjectId('61d8edabb3de40c44097e25c'), ObjectId('61d8f1fcb3de40c44097f1e3'), ObjectId('61d8efc3b3de40c44097e987'), ObjectId('61d8f00db3de40c44097eab7'), ObjectId('61d8ee17b3de40c44097e3f1'), ObjectId('61d8ed6ab3de40c44097e0c2'), ObjectId('61d91286b3de40c44097fe7c'), ObjectId('61d8f0ebb3de40c44097ee28'), ObjectId('61d8ed65b3de40c44097e060'), ObjectId('61d8ef84b3de40c44097e8d1'), ObjectId('61d8efdab3de40c44097e9d1'), ObjectId('61d8edb8b3de40c44097e286'), ObjectId('61d8f01cb3de40c44097eaff'), ObjectId('61d8ef0ab3de40c44097e757'), ObjectId('61d8ef30b3de40c44097e7b8'), ObjectId('61d8f011b3de40c44097eacf'), ObjectId('61d8ed8cb3de40c44097e19f'), ObjectId('61d8ed6fb3de40c44097e0f3'), ObjectId('61d8ee69b3de40c44097e510'), ObjectId('61d8ed6ab3de40c44097e0c3'), ObjectId('61d8f13eb3de40c44097ef9f'), ObjectId('61d8ee17b3de40c44097e3f4'), ObjectId('61d8f011b3de40c44097ead1'), ObjectId('61d8edbeb3de40c44097e2a7'), ObjectId('61d8ed82b3de40c44097e15b'), ObjectId('61d90dd7b3de40c44097f84e'), ObjectId('61d8ed78b3de40c44097e129'), ObjectId('61d8edaab3de40c44097e254'), ObjectId('61d8edd9b3de40c44097e306'), ObjectId('61d8effdb3de40c44097ea72'), ObjectId('61d8ee36b3de40c44097e458'), ObjectId('61d8f0d5b3de40c44097edd3'), ObjectId('61d8f050b3de40c44097ebec'), ObjectId('61d8ed68b3de40c44097e098'), ObjectId('61d8edb3b3de40c44097e27c'), ObjectId('61d8ee09b3de40c44097e3b2'), ObjectId('61d8f0d1b3de40c44097edc7'), ObjectId('61d8ed69b3de40c44097e0b6'), ObjectId('61d8edccb3de40c44097e2cb'), ObjectId('61d8efeab3de40c44097ea14'), ObjectId('61d8f08bb3de40c44097ecb9'), ObjectId('61d8edceb3de40c44097e2d2'), ObjectId('61d8eeb1b3de40c44097e63b'), ObjectId('61d8f0afb3de40c44097ed2e'), ObjectId('61d8ed68b3de40c44097e08f'), ObjectId('61d8f1a0b3de40c44097f121'), ObjectId('61d8f0d0b3de40c44097edc2'), ObjectId('61d8f0dcb3de40c44097eded'), ObjectId('61d8ef63b3de40c44097e862'), ObjectId('61d8ee97b3de40c44097e5e5'), ObjectId('61d8ed68b3de40c44097e07f'), ObjectId('61d8f390b3de40c44097f429'), ObjectId('61d8ed82b3de40c44097e15d'), ObjectId('61d8f105b3de40c44097ee98'), ObjectId('61d8edf9b3de40c44097e387'), ObjectId('61d8ee27b3de40c44097e425'), ObjectId('61d8f16bb3de40c44097f076'), ObjectId('61d8ed82b3de40c44097e159'), ObjectId('61d8efadb3de40c44097e93d'), ObjectId('61d8eff5b3de40c44097ea47'), ObjectId('61d8ed68b3de40c44097e099'), ObjectId('61d8ed87b3de40c44097e17a'), ObjectId('61d8ed6ab3de40c44097e0be'), ObjectId('61d8ed83b3de40c44097e15e'), ObjectId('61d8ef40b3de40c44097e7e9'), ObjectId('61d8ed85b3de40c44097e16f'), ObjectId('61d8f05fb3de40c44097ec1c'), ObjectId('61d912afb3de40c44097fea6'), ObjectId('61d8ef37b3de40c44097e7ce'), ObjectId('61d8ed68b3de40c44097e094'), ObjectId('61d8ed66b3de40c44097e06f'), ObjectId('61d8ed6cb3de40c44097e0e0'), ObjectId('61d8ee09b3de40c44097e3af'), ObjectId('61d8eee5b3de40c44097e6e1'), ObjectId('61d8f0b8b3de40c44097ed62'), ObjectId('61d8ed69b3de40c44097e09f'), ObjectId('61d8ef6ab3de40c44097e87a'), ObjectId('61d8f04eb3de40c44097ebde'), ObjectId('61d8eda2b3de40c44097e21a'), ObjectId('61d8f29cb3de40c44097f30e'), ObjectId('61d8ed89b3de40c44097e192'), ObjectId('61d8ed73b3de40c44097e10a'), ObjectId('61d8f0d8b3de40c44097eddb'), ObjectId('61d8ed6ab3de40c44097e0bf'), ObjectId('61d8ed69b3de40c44097e0b2'), ObjectId('61d8ef30b3de40c44097e7b7'), ObjectId('61d8eea1b3de40c44097e601'), ObjectId('61d8edb2b3de40c44097e278'), ObjectId('61d8ed68b3de40c44097e08b'), ObjectId('61d8eff4b3de40c44097ea46'), ObjectId('61d8ee49b3de40c44097e4a5'), ObjectId('61d8ee56b3de40c44097e4c9'), ObjectId('61d8ed65b3de40c44097e063'), ObjectId('61d90be6b3de40c44097f501'), ObjectId('61d8ed8eb3de40c44097e1b1'), ObjectId('61d8ed67b3de40c44097e073'), ObjectId('61d8f204b3de40c44097f1ef'), ObjectId('61d8ed69b3de40c44097e0b4'), ObjectId('61d8f05eb3de40c44097ec19'), ObjectId('61d8efe7b3de40c44097ea02'), ObjectId('61d8f103b3de40c44097ee8f'), ObjectId('61d8f0e1b3de40c44097ee02'), ObjectId('61d8f19eb3de40c44097f11c'), ObjectId('61d8ed68b3de40c44097e07c'), ObjectId('61d8eec5b3de40c44097e675'), ObjectId('61d8edbfb3de40c44097e2ab'), ObjectId('61d8ee59b3de40c44097e4d2'), ObjectId('61d8ef6cb3de40c44097e881'), ObjectId('61d8f0c2b3de40c44097ed91'), ObjectId('61d8ed69b3de40c44097e0aa'), ObjectId('61d8ed6ab3de40c44097e0bd'), ObjectId('61d8ed9ab3de40c44097e1f0'), ObjectId('61d8eea0b3de40c44097e600'), ObjectId('61d8ed6ab3de40c44097e0c1'), ObjectId('61d8f084b3de40c44097ec9e'), ObjectId('61d8f119b3de40c44097ef05'), ObjectId('61d90e57b3de40c44097f97a'), ObjectId('61d8eee7b3de40c44097e6e9'), ObjectId('61d8ef2fb3de40c44097e7b5'), ObjectId('61d8ef6bb3de40c44097e87e'), ObjectId('61d8ed6ab3de40c44097e0bb'), ObjectId('61d8ee71b3de40c44097e53a'), ObjectId('61d8f0feb3de40c44097ee76'), ObjectId('61d8ed99b3de40c44097e1e8'), ObjectId('61d8ee0bb3de40c44097e3bc'), ObjectId('61d8eea5b3de40c44097e60b'), ObjectId('61d8ef83b3de40c44097e8ca'), ObjectId('61d8f0f3b3de40c44097ee45'), ObjectId('61d8eef7b3de40c44097e716'), ObjectId('61d8f1a7b3de40c44097f135'), ObjectId('61d8f057b3de40c44097ebff'), ObjectId('61d90c40b3de40c44097f53f'), ObjectId('61d8ed69b3de40c44097e0a9'), ObjectId('61d8ee32b3de40c44097e44a'), ObjectId('61d8ed66b3de40c44097e06e'), ObjectId('61d8f1a8b3de40c44097f136'), ObjectId('61d8eea2b3de40c44097e604'), ObjectId('61d8ee05b3de40c44097e3a2'), ObjectId('61d8eee5b3de40c44097e6e2'), ObjectId('61d8ed69b3de40c44097e0a2'), ObjectId('61d8ed86b3de40c44097e174'), ObjectId('61d8f03db3de40c44097eb83'), ObjectId('61d8ee47b3de40c44097e49e'), ObjectId('61d9116cb3de40c44097fd2b'), ObjectId('61d8eddbb3de40c44097e312'), ObjectId('61d8ee88b3de40c44097e59f'), ObjectId('61d8ef82b3de40c44097e8c8'), ObjectId('61d8f012b3de40c44097ead9'), ObjectId('61d8ed70b3de40c44097e0f9'), ObjectId('61d8f0a3b3de40c44097ecff'), ObjectId('61d911bfb3de40c44097fdc4'), ObjectId('61d8f079b3de40c44097ec7c'), ObjectId('61d8f1eeb3de40c44097f1c4'), ObjectId('61d8edc2b3de40c44097e2b4'), ObjectId('61d8ee61b3de40c44097e4e6'), ObjectId('61d8ed66b3de40c44097e067'), ObjectId('61d8f118b3de40c44097ef02'), ObjectId('61d8f048b3de40c44097ebc1'), ObjectId('61d8f0a7b3de40c44097ed07'), ObjectId('61d8ed6ab3de40c44097e0c0'), ObjectId('61d8eebcb3de40c44097e65c'), ObjectId('61d8edb1b3de40c44097e273'), ObjectId('61d8f083b3de40c44097ec9c'), ObjectId('61d8ee0eb3de40c44097e3c3'), ObjectId('61d8ed69b3de40c44097e0a5'), ObjectId('61d8f106b3de40c44097eea1'), ObjectId('61d8f0c0b3de40c44097ed8a'), ObjectId('61d8f01eb3de40c44097eb04'), ObjectId('61d8f031b3de40c44097eb49'), ObjectId('61d8f00db3de40c44097eabb'), ObjectId('61d8ee33b3de40c44097e44d'), ObjectId('61d8f0d6b3de40c44097edd7'), ObjectId('61d8ed69b3de40c44097e0a7'), ObjectId('61d8ed66b3de40c44097e06a'), ObjectId('61d8f0cab3de40c44097edae'), ObjectId('61d8ed67b3de40c44097e076'), ObjectId('61d90d92b3de40c44097f7a0'), ObjectId('61d8eec6b3de40c44097e678'), ObjectId('61d8ef3ab3de40c44097e7d8'), ObjectId('61d8ed85b3de40c44097e170'), ObjectId('61d8efecb3de40c44097ea1e'), ObjectId('61d8ef89b3de40c44097e8e8'), ObjectId('61d8ed68b3de40c44097e088'), ObjectId('61d8eda4b3de40c44097e225'), ObjectId('61d8eeabb3de40c44097e624'), ObjectId('61d8ed64b3de40c44097e05d'), ObjectId('61d8ed73b3de40c44097e10b'), ObjectId('61d8f0fcb3de40c44097ee6e'), ObjectId('61d8ed66b3de40c44097e065'), ObjectId('61d8edb9b3de40c44097e292'), ObjectId('61d8ee4ab3de40c44097e4a9'), ObjectId('61d8ed66b3de40c44097e06b'), ObjectId('61d8ed66b3de40c44097e066'), ObjectId('61d8ed78b3de40c44097e125'), ObjectId('61d8ed84b3de40c44097e16d'), ObjectId('61d8f09bb3de40c44097ece8'), ObjectId('61d8ed69b3de40c44097e09a'), ObjectId('61d8ee6eb3de40c44097e526'), ObjectId('61d8ee79b3de40c44097e561'), ObjectId('61d8ed6ab3de40c44097e0c4'), ObjectId('61d91476b3de40c4409800bd'), ObjectId('61d8effbb3de40c44097ea68'), ObjectId('61d8eeddb3de40c44097e6c4'), ObjectId('61d8ed66b3de40c44097e069'), ObjectId('61d8ef38b3de40c44097e7d2'), ObjectId('61d8ed67b3de40c44097e07a'), ObjectId('61d8f113b3de40c44097eef0'), ObjectId('61d8f138b3de40c44097ef88'), ObjectId('61d8ee0cb3de40c44097e3bf')]
z = x.find({ "url": { "$in": url }})
rank={}
# id = []
def lijst(x):
    return sorted(x.items(), key=lambda x: x[1],reverse=True)
for i in z:
    # id.append(i['_id'])
    rank[i['url']] = i['count']
print(len(lijst(rank)))
# print(id)
end=time.now()
print(end-start)
# for i in url:
#     start = time.now()
#     z = x.find_one({'url':url})
#     end = time.now()
#     timed = end-start
#     list_time.append(timed)
#     print(timed)
# print(np.mean(list_time))
# start = time.now()
# z = x.find_one({'url':"www.amazon.com"})
# end = time.now()
# print(end-start)
# start=time.now()
# y = x.find_one({'_id': ObjectId('61d8ed66b3de40c44097e066')})
# end=time.now()
# print(end-start)
# print(y)
